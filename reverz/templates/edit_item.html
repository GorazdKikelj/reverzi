{% extends 'base.html' %}
{% block title %}
Reverz edit_item
{% endblock %}


{% block pagetitle %}
Reverz
{% endblock %}

{% block entryform %}

<div class="card text-center mb-3 bg-secondary" style="--bs-bg-opacity: .10;">
    <div class="card-body">
        <h3>{{ stranka }}</br>
            Reverz {{ rev_id }}
        </h3>
        <form action="{{url_for('reverz_edit_item',rev_id=rev_id,id=id)}}" method="POST" id="Update"">
                {{ reverz_form.hidden_tag() }}
                <div class=" form-group">
            {{ reverz_form.part_no.label(class="form-label") }}
            {{ reverz_form.part_no(class="form-control", readonly="True") }}
    </div>
    <div class="form-group">
        {{ reverz_form.description.label(class="form-label") }}
        {{ reverz_form.description(class="form-control", readonly="True") }}
    </div>
    <div class="form-group">
        {{ reverz_form.serial_no.label(class="form-label") }}
        {{ reverz_form.serial_no(class="form-control", readonly="True") }}
    </div>
    <div class="form-group">
        {{ reverz_form.demo_start_date.label(class="form-label") }}
        {% if active %}
        {{ reverz_form.demo_start_date(class="form-control") }}
        {% else %}
        {{ reverz_form.demo_start_date(class="form-control", readonly="True") }}
        {% endif%}
    </div>
    <div class="form-group">
        {{ reverz_form.demo_end_date.label(class="form-label") }}
        {% if active %}
        {{ reverz_form.demo_end_date(class="form-control") }}
        {% else %}
        {{ reverz_form.demo_end_date(class="form-control", readonly="True") }}
        {% endif%}

    </div>
    <div class="form-group">
        {{ reverz_form.demo_return_date.label(class="form-label") }}
        {{ reverz_form.demo_return_date(class="form-control") }}
    </div>
    <div class="form-group">
        {{ reverz_form.namen.label(class="form-label") }}
        {% if active %}
        {{ reverz_form.namen(class="form-control", rows="4") }}
        {% else %}
        {{ reverz_form.namen(class="form-control", rows="4", readonly="True") }}
        {% endif%}
    </div>
    <div class="form-group">
        {{ reverz_form.notes.label(class="form-label") }}
        {{ reverz_form.notes(class="form-control", rows="4") }}
    </div>
</div>
<div class="card-footer">
    {{ reverz_form.submit(class="btn btn-primary") }}
    <button class="btn ">
        <a class="btn btn-info" href="{{url_for('reverz_page')}}">Prekliči</a>
    </button>
    <!--
    <button class="btn">
        <a class="btn  btn-danger" href="{{url_for('reverz_remove',rev_id=rev_id, id=id)}}">Remove</a></button>
-->
</div>

</div>

{% endblock %}

{% block tableheader %}
<th data-valign="top"">#</th>
<th data-valign=" top" data-field="koda" data-filter-control="input" data-sortable="True">Produktna št. (Part No)</th>
<th data-valign="top" data-field="serijska" data-filter-control="input" data-sortable="True">Serijska št. (Serial No)
</th>
<th data-valign="top" data-field="opis" data-filter-control="input" data-sortable="True">Opis</th>
<th data-valign="top">
    <button class="btn">
        <a class="btn" href="{{url_for('reverz_add_item', id=rev_id)}}">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-plus-lg"
                viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                    d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z" />
            </svg>
        </a></button>
    Akcije
</th>
{% endblock %}

{% block tablerows %}
{% for row in inventory %}
<tr>
    <td>{{ row.trans_id }}</td>
    <td><span title="Notes: {{row.notes}}">{{ row.koda }}</span></td>
    <td><span title="Notes: {{row.notes}}">{{ row.serijska }}</span></td>
    <td><span title="Notes: {{row.notes}}">{{ row.opis }}
            {% if row.part_notes==None or row.part_notes=='' %}
            {% else %}
            <hr>{{ row.part_notes }}
            {% endif %}
        </span></td>
    <td>
        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <!-- Button trigger modal -->
                <button type="button" class="btn btn-sm " data-bs-toggle="modal"
                    data-bs-target="#reverzModal{{row.trans_id}}">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor"
                        class="bi bi-info-square" viewBox="0 0 16 16">
                        <path
                            d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z" />
                        <path
                            d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
                    </svg>
                </button>

                <!-- Modal -->
                <div class="modal fade" id="reverzModal{{row.trans_id}}" tabindex="-1"
                    aria-labelledby="{{row.trans_id}}" aria-hidden="true">
                    <div class="modal-dialog modal-lg modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="reverzModalLabel{{row.trans_id}}">Podrobnosti
                                </h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <table class="table-responsive table-sm table-hover bg-white">
                                    <tr>
                                        <td>Status:</td>
                                        <td>
                                            <h5>{% if row.konec|string < datum_now and row.aktivna %} POTEKEL {% elif
                                                    row.aktivna %} IZDAN {% else %} ZAKLJUČEN {% endif %}</h5>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Transakcija:</td>
                                        <td>{{ row.trans_id }}</td>
                                    </tr>
                                    <tr>
                                        <td>Inventarna št:</td>
                                        <td>{{ row.inventarna_st }}</td>
                                    </tr>
                                    <tr>
                                        <td>Part No:</td>
                                        <td>{{ row.koda }}</td>
                                    </tr>
                                    <tr>
                                        <td>Opis:</td>
                                        <td>{{ row.opis or "" }}</td>
                                    </tr>
                                    <tr>
                                        <td>Namen testiranja:</td>
                                        <td>{{ row.namen or "" }}</td>
                                    </tr>
                                    <tr>
                                        <td>Opombe:</td>
                                        <td>{{ row.notes or "" }}</td>
                                    </tr>
                                    <tr>
                                        <td>Datum izdaje:</td>
                                        <td>{{ row.začetek or "" }}</td>
                                    </tr>
                                    <tr>
                                        <td>Izdan do:</td>
                                        <td>{{ row.konec or "" }}</td>
                                    </tr>
                                    <tr>
                                        <td>Datum vračila:</td>
                                        <td>{{ row.vrnitev or "" }}</td>
                                    </tr>
                                    <tr>
                                        <td>Zadnja sprememba:</td>
                                        <td>{{ row.last_update }} {{ row.last_user or "" }}</td>
                                    </tr>

                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="btn ">
                    <a class="btn  btn-outline-primary"
                        href="{{url_for('reverz_edit_item',rev_id=rev_id,id=row.trans_id)}}">Edit</a></button>
                <button class="btn">
                    <a class="btn  btn-outline-danger"
                        href="{{url_for('reverz_remove',rev_id=rev_id, id=row.trans_id)}}">Remove</a></button>
            </div>
    </td>
</tr>
{% endfor %}
{% endblock %}